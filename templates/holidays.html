<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Public Holidays</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <h1>{{ page_title }}澳門特別行政區公眾假期 （共{{ holiday_count }}日）</h1>
    <form method="POST">
        <input type="text" name="url" placeholder="Enter URL" value="{{ url }}" size="50">
        <button type="submit">Fetch Holidays</button>
    </form>

    <input type="month" id="startMonth" name="startMonth">
    <input type="month" id="endMonth" name="endMonth">
    <button onclick="highlightMonths()">Highlight Months</button>

    <div class="month-grid">
        {% for month in range(1, 13) %}
            <div class="month" id="month-{{ month }}">
                <h2>{{ month }}月</h2>
                <ul>
                    {% for date, date_str, day, name in holidays %}
                        {% if date.month == month %}
                            <li class="{{ 'supplement' if '補假' in name else '' }}">
                                <span onclick="copyToClipboard(this)" data-clipboard-text="{{ date.strftime('%Y/%m/%d') }}">
                                    {{ date_str }} ({{ day }})
                                </span> -
                                <span onclick="copyToClipboard(this)" data-clipboard-text="{{ date.strftime('%Y/%m/%d') }} - {{ name }}">
                                    {{ name }}
                                </span>
                                {% if '補假' in name %}
                                    <img src="{{ url_for('static', filename='supplement-icon.png') }}" alt="Supplement">
                                {% endif %}
                            </li>
                        {% endif %}
                    {% endfor %}
                </ul>
            </div>
        {% endfor %}
    </div>
    <script>
    function copyToClipboard(element) {
        const pageTitle = "{{ page_title }}";  // Simulating the page title
        const year = pageTitle.match(/\d+/)[0];  // This extracts '2024' from '2024年'
        const historicalDate = element.getAttribute('data-clipboard-text');  // e.g., '1900/02/09'

        // Assuming you want to replace the year '1900' with '2024'
        const correctedDate = historicalDate.replace(/^(\d{4})/, year);

        navigator.clipboard.writeText(correctedDate).then(() => {
            // Change the color of the text to indicate it was copied
            element.style.color = 'green';

            // Optionally, reset the color after a few seconds
            setTimeout(() => {
                element.style.color = '';  // Reset to original color
            }, 2000);  // Changes back after 2 seconds
        }).catch(err => {
            console.error('Error copying text: ', err);
            // Change text color to red if there was an error
            element.style.color = 'red';
        });
    }
</script>
<script src="{{ url_for('static', filename='holidays.js') }}" defer></script>
</body>
</html>